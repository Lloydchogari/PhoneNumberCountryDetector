<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phone Country Detector</title>
    <meta name="description" content="Detect country from phone numbers - works offline">
    <meta name="theme-color" content="#000000">

    <!-- PWA manifest -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlBob25lIENvdW50cnkgRGV0ZWN0b3IiLAogICJzaG9ydF9uYW1lIjogIlBob25lRGV0ZWN0b3IiLAogICJkZXNjcmlwdGlvbiI6ICJEZXRlY3QgY291bnRyeSBmcm9tIHBob25lIG51bWJlcnMgLSB3b3JrcyBvZmZsaW5lIiwKICAic3RhcnRfdXJsIjogIi8iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiMwMDAwMDAiLAogICJ0aGVtZV9jb2xvciI6ICIjZmY2MzQ3IiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTVRreUlpQm9aV2xuYUhROU9UWWlJSFpwWlhkQ2IzZzlJakFnTUNBeE9USWdNVGt5SWlCbWFXeHNQU0lqWm1ZMk16UTNJaUJ5ZUQwaU16SWlQanh3WVhSb0lHUTlJazB4TURFdU5pQTBObEl6TVNBM01VdzVNUzQySURrM1RERHpJREV4T0V3eE1ERXVOaUEwTmtvaUlHWnBiR3c5SW1KbVptWmlabVlpTHo0OGNHRjBhQ0JrUFNKTk9UVWDNE0V4TTJFdE1UTXROak15Y0RNdU5XRXlOaUF5TmlBd0lEQXdJRGdnTVRRdE1UTTNJRFV0TWpkalpEZ3RNVFF0TVRRZ01UUXRNVFF1TnkweE55NGpJRGd1TXkweE55NHpJRUYzWWlBNUlneDZqWXpJRGd1TXlBNUlETXVOU0E0UzBveE1UZ2dOVEV5ZFdGaWxGOFB3OE1QeEVpSUdacGJHdzlJblpwYldGNE5TMDJJaTgrWGVuT2g4UEJsMlBsd1ZJVUZoTXBMZUJKdmhUK1RabklhUzlGZDAxa1VjVUQvTGNqSkJIeVVvRVJ0ZEQ9IiwKICAgICAgInNpemVzIjogIjE5Mngx"OTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfQogIF0KfQ==">
    
    <!-- Apple touch icon -->
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9IiNmZjYzNDciIHJ4PSIzMiI+PHBhdGggZD0iTTEwMS42IDQ2TDMxIDcxTDkxLjYgOTdMMCAxMThMMTAxLjYgNDZaIiBmaWxsPSJiZmZmZmZmIi8+PHBhdGggZD0iTTk1IDE0M2EtMTMgNi4zMnAzLjVhMjYgMjYgMCAwIDAgOCAxNC0xMTcgNS0yN2NEOC0xNC0xNC0xNC0xNC43LTE3LjMgOC4zLTE3LjNBM2IgOSAzeWoza1E2UDE4IDUxMnVhYmlsMF9Pd0VQd0U9IiBmaWxsPSJ3aGl0ZSIvPjwvc3ZnPg==">
    
    <!-- iOS specific meta tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Phone Detector">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            background-color: #000000;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #000000 ;
            min-height: 100vh;
            padding: 20px;
            color: white;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 40px 30px;
            background: black;
            backdrop-filter: blur(20px);
            border-radius: 24px;
            border: 1px solid rgb(107, 107, 107);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            background: orangered;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            animation: pulse 3s infinite;
            box-shadow: 0 8px 32px rgba(255, 99, 71, 0.4);
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            background: orangered;
            color: white;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 16px;
            opacity: 0.8;
        }

        .input-group {
            margin-bottom: 30px;
            position: relative;
        }

        .input-label {
            display: block;
            font-size: 14px;
            margin-bottom: 8px;
            opacity: 0.9;
            font-weight: 500;
        }

        .phone-input {
            width: 100%;
            padding: 18px 20px;
            font-size: 18px;
            border: none;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .phone-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .phone-input:focus {
            outline: none;
            border-color: #ffffff;
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .detect-btn {
            width: 100%;
            padding: 18px;
            font-size: 18px;
            font-weight: 600;
            border: none;
            border-radius: 16px;
            background: orangered;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 30px;
        }

        .detect-btn:hover {
            transform: translateY(-3px);
        }

        .detect-btn:active {
            transform: translateY(-1px);
        }

        .detect-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .result-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 25px;
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            animation: fadeIn 0.5s ease-out;
            display: none;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-card.show {
            display: block;
        }

        .result-header {
            font-size: 16px;
            opacity: 0.8;
            margin-bottom: 8px;
        }

        .result-value {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .phone-display {
            font-size: 18px;
            opacity: 0.9;
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', monospace;
        }

        .error {
            background: rgba(255, 107, 107, 0.15);
            border-color: rgba(255, 107, 107, 0.3);
        }

        .success {
            background: rgba(34, 197, 94, 0.15);
            border-color: rgba(34, 197, 94, 0.3);
        }

        .history {
            margin-top: 40px;
        }

        .history-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .history-item {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
            font-size: 14px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .history-item:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-1px);
        }

        .history-phone {
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', monospace;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .history-country {
            opacity: 0.8;
        }

        .status-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            background: rgba(34, 197, 94, 0.9);
            color: white;
            backdrop-filter: blur(10px);
            z-index: 100;
            transition: all 0.3s ease;
        }

        .offline {
            background: rgba(239, 68, 68, 0.9);
        }


        .install-btn, .dismiss-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .dismiss-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .example-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 56px;
            height: 56px;
            background: rgb(204, 51, 31);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 24px;
            transition: all 0.3s ease;
            z-index: 100;
        }


        .examples-menu {
            position: fixed;
            bottom: 90px;
            left: 20px;
            background: rgba(0, 0, 0, 0.95);
            padding: 20px;
            border-radius: 16px;
            font-size: 14px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            color: white;
            display: none;
            z-index: 99;
            min-width: 250px;
        }

        .examples-menu.show {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        .examples-title {
            margin-bottom: 15px;
            font-weight: bold;
            font-size: 16px;
        }

        .example-item {
            cursor: pointer;
            padding: 12px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            transition: all 0.2s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .example-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .flag {
            margin-right: 8px;
        }

        @media (max-width: 480px) {
            .container {
                margin: 10px;
                padding: 30px 20px;
            }
            
            body {
                padding: 10px;
            }

            .install-prompt-content {
                flex-direction: column;
                align-items: flex-start;
            }

            .install-text {
                margin-bottom: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="status-indicator" id="statusIndicator">
        🟢 Online
    </div>

    <div class="container">
        <div class="header">
            <div class="logo">📞</div>
            <h1>Phone Detective</h1>
            <div class="subtitle">Discover countries from phone numbers</div>
        </div>

        <div class="input-group">
            <label class="input-label" for="phoneInput">Phone Number</label>
            <input 
                type="tel" 
                id="phoneInput" 
                class="phone-input" 
                placeholder="+1 415 555 2671"
                autocomplete="tel"
            >
        </div>

        <button class="detect-btn" id="detectBtn" onclick="detectCountry()">
            🔍 Detect Country
        </button>

        <div class="result-card" id="resultCard">
            <div class="result-header">Country/Region</div>
            <div class="result-value" id="countryResult"></div>
            <div class="phone-display" id="phoneDisplay"></div>
        </div>

        <div class="history" id="historySection" style="display: none;">
            <div class="history-title">Recent Searches</div>
            <div id="historyList"></div>
        </div>
    </div>

    <div class="example-btn" onclick="toggleExamples()" id="exampleBtn">
        💡
    </div>

    <div class="examples-menu" id="examplesMenu">
        <div class="examples-title">Try these examples:</div>
        <div class="example-item" onclick="fillExample('+1 415 555 2671')">
            <span class="flag">🇺🇸</span>+1 415 555 2671 (US)
        </div>
        <div class="example-item" onclick="fillExample('+44 20 7946 0958')">
            <span class="flag">🇬🇧</span>+44 20 7946 0958 (UK)
        </div>
        <div class="example-item" onclick="fillExample('+49 30 12345678')">
            <span class="flag">🇩🇪</span>+49 30 12345678 (Germany)
        </div>
        <div class="example-item" onclick="fillExample('+81 3 1234 5678')">
            <span class="flag">🇯🇵</span>+81 3 1234 5678 (Japan)
        </div>
        <div class="example-item" onclick="fillExample('+33 1 42 86 83 26')">
            <span class="flag">🇫🇷</span>+33 1 42 86 83 26 (France)
        </div>
    </div>

    <script>
        // Complete country data for offline functionality
        const countryData = {
            'US': 'United States',
            'CA': 'Canada',
            'GB': 'United Kingdom',
            'FR': 'France',
            'DE': 'Germany',
            'IT': 'Italy',
            'ES': 'Spain',
            'AU': 'Australia',
            'JP': 'Japan',
            'CN': 'China',
            'IN': 'India',
            'BR': 'Brazil',
            'MX': 'Mexico',
            'RU': 'Russia',
            'KR': 'South Korea',
            'NL': 'Netherlands',
            'SE': 'Sweden',
            'NO': 'Norway',
            'DK': 'Denmark',
            'FI': 'Finland',
            'CH': 'Switzerland',
            'AT': 'Austria',
            'BE': 'Belgium',
            'PL': 'Poland',
            'TR': 'Turkey',
            'GR': 'Greece',
            'PT': 'Portugal',
            'IE': 'Ireland',
            'CZ': 'Czech Republic',
            'HU': 'Hungary',
            'RO': 'Romania',
            'BG': 'Bulgaria',
            'HR': 'Croatia',
            'SK': 'Slovakia',
            'SI': 'Slovenia',
            'LT': 'Lithuania',
            'LV': 'Latvia',
            'EE': 'Estonia',
            'IS': 'Iceland',
            'MT': 'Malta',
            'CY': 'Cyprus',
            'LU': 'Luxembourg',
            'AR': 'Argentina',
            'CL': 'Chile',
            'CO': 'Colombia',
            'PE': 'Peru',
            'VE': 'Venezuela',
            'UY': 'Uruguay',
            'PY': 'Paraguay',
            'BO': 'Bolivia',
            'EC': 'Ecuador',
            'GT': 'Guatemala',
            'HN': 'Honduras',
            'SV': 'El Salvador',
            'NI': 'Nicaragua',
            'CR': 'Costa Rica',
            'PA': 'Panama',
            'DO': 'Dominican Republic',
            'CU': 'Cuba',
            'JM': 'Jamaica',
            'HT': 'Haiti',
            'PR': 'Puerto Rico',
            'ZA': 'South Africa',
            'EG': 'Egypt',
            'NG': 'Nigeria',
            'KE': 'Kenya',
            'GH': 'Ghana',
            'ET': 'Ethiopia',
            'TZ': 'Tanzania',
            'UG': 'Uganda',
            'ZW': 'Zimbabwe',
            'MA': 'Morocco',
            'DZ': 'Algeria',
            'TN': 'Tunisia',
            'LY': 'Libya',
            'SD': 'Sudan',
            'AO': 'Angola',
            'MZ': 'Mozambique',
            'MG': 'Madagascar',
            'ZM': 'Zambia',
            'MW': 'Malawi',
            'BW': 'Botswana',
            'NA': 'Namibia',
            'SZ': 'Eswatini',
            'LS': 'Lesotho',
            'TH': 'Thailand',
            'VN': 'Vietnam',
            'MY': 'Malaysia',
            'SG': 'Singapore',
            'PH': 'Philippines',
            'ID': 'Indonesia',
            'MM': 'Myanmar',
            'KH': 'Cambodia',
            'LA': 'Laos',
            'BN': 'Brunei',
            'TL': 'East Timor',
            'NZ': 'New Zealand',
            'FJ': 'Fiji',
            'PG': 'Papua New Guinea',
            'SB': 'Solomon Islands',
            'VU': 'Vanuatu',
            'NC': 'New Caledonia',
            'PF': 'French Polynesia',
            'WS': 'Samoa',
            'TO': 'Tonga',
            'KI': 'Kiribati',
            'TV': 'Tuvalu',
            'NR': 'Nauru',
            'PW': 'Palau',
            'FM': 'Micronesia',
            'MH': 'Marshall Islands',
            'IL': 'Israel',
            'JO': 'Jordan',
            'LB': 'Lebanon',
            'SY': 'Syria',
            'IQ': 'Iraq',
            'IR': 'Iran',
            'SA': 'Saudi Arabia',
            'AE': 'United Arab Emirates',
            'QA': 'Qatar',
            'KW': 'Kuwait',
            'BH': 'Bahrain',
            'OM': 'Oman',
            'YE': 'Yemen',
            'AF': 'Afghanistan',
            'PK': 'Pakistan',
            'BD': 'Bangladesh',
            'LK': 'Sri Lanka',
            'MV': 'Maldives',
            'BT': 'Bhutan',
            'NP': 'Nepal',
            'MN': 'Mongolia',
            'KZ': 'Kazakhstan',
            'KG': 'Kyrgyzstan',
            'TJ': 'Tajikistan',
            'TM': 'Turkmenistan',
            'UZ': 'Uzbekistan',
            'GE': 'Georgia',
            'AM': 'Armenia',
            'AZ': 'Azerbaijan',
            'BY': 'Belarus',
            'UA': 'Ukraine',
            'MD': 'Moldova',
            'RO': 'Romania'
        };



     // Phone number parsing patterns for all world country codes (E.164 standard)
const phonePatterns = {
    "1": { country: "US/CA/Caribbean", minLength: 10, maxLength: 10 },
    "7": { country: "RU/KZ", minLength: 10, maxLength: 10 },
    "20": { country: "EG", minLength: 10, maxLength: 11 },
    "27": { country: "ZA", minLength: 9, maxLength: 9 },
    "30": { country: "GR", minLength: 10, maxLength: 10 },
    "31": { country: "NL", minLength: 9, maxLength: 9 },
    "32": { country: "BE", minLength: 8, maxLength: 9 },
    "33": { country: "FR", minLength: 9, maxLength: 10 },
    "34": { country: "ES", minLength: 9, maxLength: 9 },
    "36": { country: "HU", minLength: 8, maxLength: 9 },
    "39": { country: "IT", minLength: 9, maxLength: 11 },
    "40": { country: "RO", minLength: 9, maxLength: 9 },
    "41": { country: "CH", minLength: 9, maxLength: 9 },
    "43": { country: "AT", minLength: 4, maxLength: 13 },
    "44": { country: "GB", minLength: 10, maxLength: 11 },
    "45": { country: "DK", minLength: 8, maxLength: 8 },
    "46": { country: "SE", minLength: 7, maxLength: 9 },
    "47": { country: "NO", minLength: 8, maxLength: 8 },
    "48": { country: "PL", minLength: 9, maxLength: 9 },
    "49": { country: "DE", minLength: 11, maxLength: 12 },
    "51": { country: "PE", minLength: 8, maxLength: 9 },
    "52": { country: "MX", minLength: 10, maxLength: 10 },
    "53": { country: "CU", minLength: 8, maxLength: 8 },
    "54": { country: "AR", minLength: 6, maxLength: 13 },
    "55": { country: "BR", minLength: 10, maxLength: 11 },
    "56": { country: "CL", minLength: 8, maxLength: 9 },
    "57": { country: "CO", minLength: 10, maxLength: 10 },
    "58": { country: "VE", minLength: 10, maxLength: 10 },
    "60": { country: "MY", minLength: 8, maxLength: 10 },
    "61": { country: "AU", minLength: 9, maxLength: 9 },
    "62": { country: "ID", minLength: 7, maxLength: 11 },
    "63": { country: "PH", minLength: 10, maxLength: 10 },
    "64": { country: "NZ", minLength: 8, maxLength: 9 },
    "65": { country: "SG", minLength: 8, maxLength: 8 },
    "66": { country: "TH", minLength: 8, maxLength: 9 },
    "81": { country: "JP", minLength: 10, maxLength: 11 },
    "82": { country: "KR", minLength: 8, maxLength: 11 },
    "84": { country: "VN", minLength: 9, maxLength: 10 },
    "86": { country: "CN", minLength: 11, maxLength: 11 },
    "90": { country: "TR", minLength: 10, maxLength: 10 },
    "91": { country: "IN", minLength: 10, maxLength: 10 },
    "92": { country: "PK", minLength: 10, maxLength: 10 },
    "93": { country: "AF", minLength: 9, maxLength: 9 },
    "94": { country: "LK", minLength: 9, maxLength: 9 },
    "95": { country: "MM", minLength: 8, maxLength: 10 },
    "98": { country: "IR", minLength: 10, maxLength: 10 },
    "211": { country: "SS", minLength: 9, maxLength: 9 },
    "212": { country: "MA", minLength: 9, maxLength: 9 },
    "213": { country: "DZ", minLength: 9, maxLength: 9 },
    "216": { country: "TN", minLength: 8, maxLength: 8 },
    "218": { country: "LY", minLength: 9, maxLength: 9 },
    "220": { country: "GM", minLength: 7, maxLength: 7 },
    "221": { country: "SN", minLength: 9, maxLength: 9 },
    "222": { country: "MR", minLength: 8, maxLength: 8 },
    "223": { country: "ML", minLength: 8, maxLength: 8 },
    "224": { country: "GN", minLength: 9, maxLength: 9 },
    "225": { country: "CI", minLength: 8, maxLength: 10 },
    "226": { country: "BF", minLength: 8, maxLength: 8 },
    "227": { country: "NE", minLength: 8, maxLength: 8 },
    "228": { country: "TG", minLength: 8, maxLength: 8 },
    "229": { country: "BJ", minLength: 8, maxLength: 8 },
    "230": { country: "MU", minLength: 8, maxLength: 8 },
    "231": { country: "LR", minLength: 7, maxLength: 8 },
    "232": { country: "SL", minLength: 8, maxLength: 8 },
    "233": { country: "GH", minLength: 9, maxLength: 9 },
    "234": { country: "NG", minLength: 7, maxLength: 8 },
    "235": { country: "TD", minLength: 8, maxLength: 8 },
    "236": { country: "CF", minLength: 8, maxLength: 8 },
    "237": { country: "CM", minLength: 8, maxLength: 9 },
    "238": { country: "CV", minLength: 7, maxLength: 7 },
    "239": { country: "ST", minLength: 7, maxLength: 7 },
    "240": { country: "GQ", minLength: 9, maxLength: 9 },
    "241": { country: "GA", minLength: 7, maxLength: 7 },
    "242": { country: "CG", minLength: 9, maxLength: 9 },
    "243": { country: "CD", minLength: 9, maxLength: 9 },
    "244": { country: "AO", minLength: 9, maxLength: 9 },
    "248": { country: "SC", minLength: 7, maxLength: 7 },
    "249": { country: "SD", minLength: 9, maxLength: 9 },
    "250": { country: "RW", minLength: 9, maxLength: 9 },
    "251": { country: "ET", minLength: 9, maxLength: 9 },
    "252": { country: "SO", minLength: 8, maxLength: 9 },
    "253": { country: "DJ", minLength: 8, maxLength: 8 },
    "254": { country: "KE", minLength: 9, maxLength: 9 },
    "255": { country: "TZ", minLength: 9, maxLength: 9 },
    "256": { country: "UG", minLength: 9, maxLength: 9 },
    "257": { country: "BI", minLength: 8, maxLength: 8 },
    "258": { country: "MZ", minLength: 9, maxLength: 9 },
    "260": { country: "ZM", minLength: 9, maxLength: 9 },
    "261": { country: "MG", minLength: 9, maxLength: 9 },
    "262": { country: "RE/YT", minLength: 9, maxLength: 9 },
    "263": { country: "ZW", minLength: 9, maxLength: 9 },
    "264": { country: "NA", minLength: 9, maxLength: 9 },
    "265": { country: "MW", minLength: 9, maxLength: 9 },
    "266": { country: "LS", minLength: 8, maxLength: 8 },
    "267": { country: "BW", minLength: 7, maxLength: 8 },
    "268": { country: "SZ", minLength: 8, maxLength: 8 },
    "269": { country: "KM", minLength: 7, maxLength: 7 },
    "290": { country: "SH", minLength: 4, maxLength: 4 },
    "291": { country: "ER", minLength: 7, maxLength: 7 },
    "297": { country: "AW", minLength: 7, maxLength: 7 },
    "298": { country: "FO", minLength: 6, maxLength: 6 },
    "299": { country: "GL", minLength: 6, maxLength: 6 },
    "350": { country: "GI", minLength: 8, maxLength: 8 },
    "351": { country: "PT", minLength: 9, maxLength: 9 },
    "352": { country: "LU", minLength: 4, maxLength: 11 },
    "353": { country: "IE", minLength: 7, maxLength: 9 },
    "354": { country: "IS", minLength: 7, maxLength: 7 },
    "355": { country: "AL", minLength: 8, maxLength: 9 },
    "356": { country: "MT", minLength: 8, maxLength: 8 },
    "357": { country: "CY", minLength: 8, maxLength: 8 },
    "358": { country: "FI", minLength: 5, maxLength: 12 },
    "359": { country: "BG", minLength: 8, maxLength: 9 },
    "370": { country: "LT", minLength: 8, maxLength: 8 },
    "371": { country: "LV", minLength: 8, maxLength: 8 },
    "372": { country: "EE", minLength: 7, maxLength: 8 },
    "373": { country: "MD", minLength: 8, maxLength: 8 },
    "374": { country: "AM", minLength: 8, maxLength: 8 },
    "375": { country: "BY", minLength: 9, maxLength: 9 },
    "376": { country: "AD", minLength: 6, maxLength: 6 },
    "377": { country: "MC", minLength: 8, maxLength: 8 },
    "378": { country: "SM", minLength: 10, maxLength: 10 },
    "379": { country: "VA", minLength: 6, maxLength: 6 },
    "380": { country: "UA", minLength: 9, maxLength: 9 },
    "381": { country: "RS", minLength: 8, maxLength: 9 },
    "382": { country: "ME", minLength: 8, maxLength: 8 },
    "383": { country: "XK", minLength: 8, maxLength: 8 },
    "385": { country: "HR", minLength: 8, maxLength: 9 },
    "386": { country: "SI", minLength: 8, maxLength: 8 },
    "387": { country: "BA", minLength: 8, maxLength: 8 },
    "389": { country: "MK", minLength: 8, maxLength: 8 },
    "420": { country: "CZ", minLength: 9, maxLength: 9 },
    "421": { country: "SK", minLength: 9, maxLength: 9 },
    "423": { country: "LI", minLength: 7, maxLength: 7 },
    "500": { country: "FK", minLength: 5, maxLength: 5 },
    "501": { country: "BZ", minLength: 7, maxLength: 7 },
    "502": { country: "GT", minLength: 8, maxLength: 8 },
    "503": { country: "SV", minLength: 8, maxLength: 8 },
    "504": { country: "HN", minLength: 8, maxLength: 8 },
    "505": { country: "NI", minLength: 8, maxLength: 8 },
    "506": { country: "CR", minLength: 8, maxLength: 8 },
    "507": { country: "PA", minLength: 8, maxLength: 8 },
    "508": { country: "PM", minLength: 6, maxLength: 6 },
    "509": { country: "HT", minLength: 8, maxLength: 8 },
    "590": { country: "GP/MF/BL", minLength: 9, maxLength: 9 },
    "591": { country: "BO", minLength: 8, maxLength: 8 },
    "592": { country: "GY", minLength: 7, maxLength: 7 },
    "593": { country: "EC", minLength: 8, maxLength: 9 },
    "594": { country: "GF", minLength: 9, maxLength: 9 },
    "595": { country: "PY", minLength: 8, maxLength: 9 },
    "596": { country: "MQ", minLength: 9, maxLength: 9 },
    "597": { country: "SR", minLength: 7, maxLength: 7 },
    "598": { country: "UY", minLength: 8, maxLength: 8 },
    "599": { country: "CW/BQ", minLength: 7, maxLength: 8 },
    "670": { country: "TL", minLength: 7, maxLength: 7 },
    "672": { country: "AQ/NF", minLength: 6, maxLength: 6 },
    "673": { country: "BN", minLength: 7, maxLength: 7 },
    "674": { country: "NR", minLength: 7, maxLength: 7 },
    "675": { country: "PG", minLength: 8, maxLength: 8 },
    "676": { country: "TO", minLength: 7, maxLength: 7 },
    "677": { country: "SB", minLength: 7, maxLength: 7 },
    "678": { country: "VU", minLength: 7, maxLength: 7 },
    "679": { country: "FJ", minLength: 7, maxLength: 7 },
    "680": { country: "PW", minLength: 7, maxLength: 7 },
    "681": { country: "WF", minLength: 6, maxLength: 6 },
    "682": { country: "CK", minLength: 5, maxLength: 5 },
    "683": { country: "NU", minLength: 4, maxLength: 4 },
    "685": { country: "WS", minLength: 7, maxLength: 7 },
    "686": { country: "KI", minLength: 8, maxLength: 8 },
    "687": { country: "NC", minLength: 6, maxLength: 6 },
    "688": { country: "TV", minLength: 5, maxLength: 5 },
    "689": { country: "PF", minLength: 8, maxLength: 8 },
    "690": { country: "TK", minLength: 4, maxLength: 4 },
    "691": { country: "FM", minLength: 7, maxLength: 7 },
    "692": { country: "MH", minLength: 7, maxLength: 7 },
    "850": { country: "KP", minLength: 9, maxLength: 10 },
    "852": { country: "HK", minLength: 8, maxLength: 8 },
    "853": { country: "MO", minLength: 8, maxLength: 8 },
    "855": { country: "KH", minLength: 8, maxLength: 9 },
    "856": { country: "LA", minLength: 8, maxLength: 10 },
    "880": { country: "BD", minLength: 10, maxLength: 10 },
    "886": { country: "TW", minLength: 9, maxLength: 9 },
    "960": { country: "MV", minLength: 7, maxLength: 7 },
    "961": { country: "LB", minLength: 7, maxLength: 8 },
    "962": { country: "JO", minLength: 8, maxLength: 9 },
    "963": { country: "SY", minLength: 8, maxLength: 9 },
    "964": { country: "IQ", minLength: 8, maxLength: 10 },
    "965": { country: "KW", minLength: 8, maxLength: 8 },
    "966": { country: "SA", minLength: 8, maxLength: 9 },
    "967": { country: "YE", minLength: 8, maxLength: 9 },
    "968": { country: "OM", minLength: 8, maxLength: 8 },
    "970": { country: "PS", minLength: 8, maxLength: 9 },
    "971": { country: "AE", minLength: 8, maxLength: 9 },
    "972": { country: "IL", minLength: 8, maxLength: 9 },
    "973": { country: "BH", minLength: 8, maxLength: 8 },
    "974": { country: "QA", minLength: 8, maxLength: 8 },
    "975": { country: "BT", minLength: 8, maxLength: 8 },
    "976": { country: "MN", minLength: 8, maxLength: 9 },
    "977": { country: "NP", minLength: 8, maxLength: 10 },
    "992": { country: "TJ", minLength: 9, maxLength: 9 },
    "993": { country: "TM", minLength: 8, maxLength: 8 },
    "994": { country: "AZ", minLength: 9, maxLength: 9 },
    "995": { country: "GE", minLength: 9, maxLength: 9 },
    "996": { country: "KG", minLength: 9, maxLength: 9 },
    "998": { country: "UZ", minLength: 9, maxLength: 9 }
};


        // PWA variables
        let deferredPrompt;
        let searchHistory = [];

        // Load search history from memory (no localStorage dependency for offline)
        function loadHistory() {
            try {
                const stored = localStorage.getItem('phoneSearchHistory');
                if (stored) {
                    searchHistory = JSON.parse(stored);
                }
            } catch (e) {
                console.log('localStorage not available, using memory storage');
                searchHistory = [];
            }
        }

        // Save search history
        function saveHistory() {
            try {
                localStorage.setItem('phoneSearchHistory', JSON.stringify(searchHistory));
            } catch (e) {
                console.log('localStorage not available, using memory storage only');
            }
        }

        // Service Worker registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('/sw.js');
                    console.log('Service Worker registered successfully:', registration);
                    
                    // Listen for updates
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                console.log('New version available');
                            }
                        });
                    });
                } catch (error) {
                    console.log('Service Worker registration failed:', error);
                }
            });
        }

        // Install prompt handling
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            showInstallPrompt();
        });

        window.addEventListener('appinstalled', () => {
            hideInstallPrompt();
            console.log('PWA was installed');
        });

        function showInstallPrompt() {
            const prompt = document.getElementById('installPrompt');
            setTimeout(() => {
                prompt.classList.add('show');
            }, 3000);
        }

        function hideInstallPrompt() {
            const prompt = document.getElementById('installPrompt');
            prompt.classList.remove('show');
        }

        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                    }
                    deferredPrompt = null;
                });
            }
            hideInstallPrompt();
        }

        function dismissInstall() {
            hideInstallPrompt();
        }

        // Network status handling
        function updateNetworkStatus() {
            const indicator = document.getElementById('statusIndicator');
            if (navigator.onLine) {
                indicator.textContent = '🟢 Online';
                indicator.classList.remove('offline');
            } else {
                indicator.textContent = '🔴 Offline';
                indicator.classList.add('offline');
            }
        }

        window.addEventListener('online', updateNetworkStatus);
        window.addEventListener('offline', updateNetworkStatus);

        // Phone number detection function - works completely offline
        function detectCountry() {
            const phoneInput = document.getElementById('phoneInput');
            const phoneNumber = phoneInput.value.trim();
            const detectBtn = document.getElementById('detectBtn');

            if (!phoneNumber) {
                showResult('Please enter a phone number', phoneNumber, false);
                return;
            }

            detectBtn.disabled = true;
            detectBtn.textContent = '🔍 Detecting...';

            try {
                const result = parsePhoneNumber(phoneNumber);
                if (result.isValid) {
                    const countryName = countryData[result.country] || result.country;
                    showResult(countryName, result.formattedNumber, true);
                    addToHistory(result.formattedNumber, countryName);
                } else {
                    throw new Error('Invalid phone number format');
                }
            } catch (error) {
                console.error('Error parsing phone number:', error);
                showResult('Invalid phone number format. Please include country code (e.g., +1 for US)', phoneNumber, false);
            }

            detectBtn.disabled = false;
            detectBtn.textContent = '🔍 Detect Country';
        }

        // Offline phone number parsing function
        function parsePhoneNumber(phoneNumber) {
            // Remove all non-digit characters except +
            let cleaned = phoneNumber.replace(/[^\d+]/g, '');
            
            // Must start with +
            if (!cleaned.startsWith('+')) {
                throw new Error('Phone number must start with country code (+)');
            }

            // Remove the + for processing
            cleaned = cleaned.substring(1);
            
            if (cleaned.length < 7 || cleaned.length > 15) {
                throw new Error('Invalid phone number length');
            }

            // Try to match country codes (longest first)
            const sortedCodes = Object.keys(phonePatterns).sort((a, b) => b.length - a.length);
            
            for (const code of sortedCodes) {
                if (cleaned.startsWith(code)) {
                    const nationalNumber = cleaned.substring(code.length);
                    const pattern = phonePatterns[code];
                    
                    if (nationalNumber.length >= pattern.minLength && nationalNumber.length <= pattern.maxLength) {
                        return {
                            isValid: true,
                            country: pattern.country,
                            countryCode: code,
                            nationalNumber: nationalNumber,
                            formattedNumber: formatPhoneNumber(code, nationalNumber)
                        };
                    }
                }
            }
            
            throw new Error('Unrecognized country code or invalid number format');
        }

        // Format phone number for display
        function formatPhoneNumber(countryCode, nationalNumber) {
            // Basic formatting - add spaces for readability
            let formatted = '+' + countryCode + ' ';
            
            // Add basic formatting based on country
            switch (countryCode) {
                case '1': // US/Canada
                    if (nationalNumber.length === 10) {
                        formatted += nationalNumber.substring(0, 3) + ' ' + 
                                   nationalNumber.substring(3, 6) + ' ' + 
                                   nationalNumber.substring(6);
                    } else {
                        formatted += nationalNumber;
                    }
                    break;
                case '44': // UK
                    if (nationalNumber.length >= 10) {
                        formatted += nationalNumber.substring(0, 2) + ' ' + 
                                   nationalNumber.substring(2, 6) + ' ' + 
                                   nationalNumber.substring(6);
                    } else {
                        formatted += nationalNumber;
                    }
                    break;
                case '49': // Germany
                    if (nationalNumber.length >= 10) {
                        formatted += nationalNumber.substring(0, 2) + ' ' + 
                                   nationalNumber.substring(2);
                    } else {
                        formatted += nationalNumber;
                    }
                    break;
                default:
                    // Generic formatting - add space every 3-4 digits
                    let remaining = nationalNumber;
                    while (remaining.length > 4) {
                        formatted += remaining.substring(0, 3) + ' ';
                        remaining = remaining.substring(3);
                    }
                    formatted += remaining;
            }
            
            return formatted;
        }

        function showResult(country, phone, isSuccess) {
            const resultCard = document.getElementById('resultCard');
            const countryResult = document.getElementById('countryResult');
            const phoneDisplay = document.getElementById('phoneDisplay');

            countryResult.textContent = country;
            phoneDisplay.textContent = phone;
            
            resultCard.className = 'result-card show ' + (isSuccess ? 'success' : 'error');
        }

        function addToHistory(phone, country) {
            const historyItem = {
                phone: phone,
                country: country,
                timestamp: new Date().toLocaleString()
            };

            // Add to beginning of array and limit to 10 items
            searchHistory.unshift(historyItem);
            searchHistory = searchHistory.slice(0, 10);
            
            // Save to storage
            saveHistory();
            
            // Update display
            updateHistoryDisplay();
        }

        function updateHistoryDisplay() {
            const historySection = document.getElementById('historySection');
            const historyList = document.getElementById('historyList');

            if (searchHistory.length === 0) {
                historySection.style.display = 'none';
                return;
            }

            historySection.style.display = 'block';
            historyList.innerHTML = '';

            searchHistory.forEach((item, index) => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.onclick = () => {
                    document.getElementById('phoneInput').value = item.phone;
                    detectCountry();
                };
                historyItem.innerHTML = `
                    <div class="history-phone">${item.phone}</div>
                    <div class="history-country">${item.country}</div>
                `;
                historyList.appendChild(historyItem);
            });
        }

        // Examples functionality
        function toggleExamples() {
            const menu = document.getElementById('examplesMenu');
            const btn = document.getElementById('exampleBtn');
            
            if (menu.classList.contains('show')) {
                menu.classList.remove('show');
                btn.innerHTML = '💡';
                btn.style.transform = 'rotate(0deg)';
            } else {
                menu.classList.add('show');
                btn.innerHTML = '✖️';
                btn.style.transform = 'rotate(180deg)';
            }
        }

        function fillExample(number) {
            document.getElementById('phoneInput').value = number;
            toggleExamples(); // Close the menu
            detectCountry();
        }

        // Close examples menu when clicking outside
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('examplesMenu');
            const btn = document.getElementById('exampleBtn');
            
            if (!menu.contains(event.target) && !btn.contains(event.target)) {
                menu.classList.remove('show');
                btn.innerHTML = '💡';
                btn.style.transform = 'rotate(0deg)';
            }
        });

        // Enter key support
        document.getElementById('phoneInput').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                detectCountry();
            }
        });

        // Auto-format phone input
        document.getElementById('phoneInput').addEventListener('input', function(event) {
            let value = event.target.value;
            
            // Remove all non-numeric characters except + and spaces
            value = value.replace(/[^\d\s\+\-\(\)]/g, '');
            
            // Ensure + is only at the beginning
            if (value.indexOf('+') > 0) {
                value = value.replace(/\+/g, '');
                value = '+' + value;
            }
            
            event.target.value = value;
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            // Ctrl/Cmd + K to focus input
            if ((event.ctrlKey || event.metaKey) && event.key === 'k') {
                event.preventDefault();
                document.getElementById('phoneInput').focus();
                document.getElementById('phoneInput').select();
            }
            
            // Escape to close examples
            if (event.key === 'Escape') {
                const menu = document.getElementById('examplesMenu');
                const btn = document.getElementById('exampleBtn');
                menu.classList.remove('show');
                btn.innerHTML = '💡';
                btn.style.transform = 'rotate(0deg)';
            }
        });

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            updateNetworkStatus();
            loadHistory();
            updateHistoryDisplay();
            
            // Auto-focus input on desktop
            if (window.innerWidth > 768) {
                document.getElementById('phoneInput').focus();
            }
        });
    </script>
</body>
</html>